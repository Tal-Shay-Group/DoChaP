<html>
<!-- this page shows different views. we use canvases for graphics. -->

<body ng-app="DoChaP" ng-controller="resultsCtrl">

    <!--tooltip-->
    <span id="myTooltip">Tooltip text</span>

    <!-- modal work class="modal"-->
    <div id="BlackBackground"
        style="position: fixed; z-index: 2; display: none; height: 100%; width: 100%; top: 0px; left: 0px;"
        ng-show="showWindow" ng-click="closeModalFromBackground($event)">
        <div id="myModal">
            <div width="200" ng-click="showWindow=false" style="font-size: 25px;text-align: right; padding: 0px;">
                <span class="glyphicon glyphicon-remove-sign"></span></div><br>
            <span ng-if="showWindow=='gene'">
                GeneID: <a href="https://www.ncbi.nlm.nih.gov/gene/{{::resultsCtrl.geneInfo.gene_GeneID_id}}"
                    target="_blank"></a>{{::resultsCtrl.geneInfo.gene_GeneID_id}}<br>
                Gene symbol: {{::resultsCtrl.geneInfo.gene_symbol}}<br>
                Chromosome: {{::resultsCtrl.geneInfo.chromosome}}<br>
                Synonyms: {{::resultsCtrl.geneInfo.synonyms}}<br>
                Strand: {{::resultsCtrl.geneInfo.strand}}<br>
                Description: {{::resultsCtrl.geneInfo.description}}<br>
                <!-- MGI ID: <a href="http://www.informatics.jax.org/marker/MGI:{{::resultsCtrl.geneInfo.MGI_id}}"
                    target="_blank">{{::resultsCtrl.geneInfo.MGI_id}}</a><br> -->
                Ensembl ID:
                <a href="{{::resultsCtrl.geneInfo.EnsemblLink}}"
                    target="_blank">{{::resultsCtrl.geneInfo.gene_ensembl_id}}</a>

            </span>
            <span ng-show="showWindow=='transcript'">
                RefSeq ID: <a
                    href="https://www.ncbi.nlm.nih.gov/nuccore/{{resultsCtrl.currTranscript.transcript_refseq_id}}"
                    target="_blank">{{resultsCtrl.currTranscript.transcript_refseq_id}}</a><br>
                Exon count: {{resultsCtrl.currTranscript.exonCount}}<br>
                <span ng-show="resultsCtrl.currTranscript.ucsc_id!=undefined">
                    UCSC ID: <a
                        href="https://genome.ucsc.edu/cgi-bin/hgTracks?id={{resultsCtrl.currTranscript.proteinUniprotID}}"
                        target="_blank">{{resultsCtrl.currTranscript.ucsc_id}}</a> <br>
                </span>
                <span ng-show="resultsCtrl.currTranscript.transcript_ensembl_id!=undefined">
                    Ensembl ID:
                    <a href="{{resultsCtrl.currTranscript.transcriptEnsemblLink}}"
                        target="_blank">{{resultsCtrl.currTranscript.transcript_ensembl_id}}</a><br>

                </span>
                Transcription start: {{resultsCtrl.currTranscript.tx_start}}<br>
                Transcription end: {{resultsCtrl.currTranscript.tx_end}}<br>
                CDS start: {{resultsCtrl.currTranscript.cds_start}}<br>
                CDS end: {{resultsCtrl.currTranscript.cds_end}}
            </span>
            <span ng-show="showWindow=='protein'">
                RefSeq ID: <a href=" https://www.ncbi.nlm.nih.gov/protein/{{resultsCtrl.currTranscript.proteinId}}"
                    target="_blank">{{resultsCtrl.currTranscript.protein_refseq_id}}</a><br>
                Description: {{resultsCtrl.currTranscript.description}} <br>
                Synonyms: {{resultsCtrl.currTranscript.synonyms}}<br>
                AA length: {{resultsCtrl.currTranscript.proteinLengthInAA}}<br>
                <!-- <span ng-show="resultsCtrl.currTranscript.proteinUniprotID!=undefined">
                    UniProt ID: <a
                        href="https://www.uniprot.org/uniprot/{{resultsCtrl.currTranscript.proteinUniprotID}}"
                        target="_blank">{{resultsCtrl.currTranscript.proteinUniprotID}}</a> <br>
                </span> -->
                <span ng-show="resultsCtrl.currTranscript.protein_ensembl_id!=undefined">
                    Ensembl ID:
                    <a href="{{resultsCtrl.currTranscript.proteinEnsemblLink}}"
                        target="_blank">{{resultsCtrl.currTranscript.protein_ensembl_id}}</a>

                </span>
            </span>
        </div>
    </div>
    <!--end of modal work-->

    <!-- gene introduction -->
    <div id="searchExists" ng-show="!{{::noSearch}}"
        style="background-color: white;position: absolute;z-index: -3; width: 100%;">

        <br>
        <div class="greyArea searchItems">
            <div  class="searchItems">

           
            {{::transcripts.length}} transcripts found for gene <a href=""><b
                    ng-click="openWindow('gene',undefined)">{{::resultsCtrl.geneInfo.gene_symbol}}</b></a> in
            {{::resultsCtrl.geneInfo.specieName}} <br>

            <i>Choose Display</i>
            <br>
            <select id="selectModeComboBox" class="form-control selectMode" ng-click="checkboxChecked()">
                <option value="all">All Views</option>
                <option value="transcript_protein">Transcript & Protein Views</option>
                <option value="genomic">Genomic View Only</option>
                <option value="transcript">Transcript View Only</option>
                <option value="protein">Protein View Only</option>


            </select>
            <input type="checkbox" ng-click="filterUnreviewed()" id="isReviewedCheckBox"><i>hide predicted records</i>
            <br>
            <button ng-click="downloadPDF()" class="btn blackButton">
                <span class="glyphicon glyphicon-download-alt"></span> Save As PDF
            </button> 
        </div>
        </div>
        <br>
        <!--

                <input style="margin: 5px" type="button" class="btn blackButton" value="Zoom In (+)" ng-click="extendCanvases(400)"
                style="width: 100px;" />&nbsp;&nbsp;
                <input type="button" class="btn blackButton" value="Zoom Out (-)"
                ng-click="extendCanvases(-400)" style="width: 100px;" />
        -->


        <!-- list of transcripts -->
        <center>
            <table class="resultTable">
                <tr>
                    <!-- titles-->
                    <td class="resultTitle" ng-show="viewMode=='all'|| viewMode=='genomic'" class="resultTitle">
                        Genomic
                        <!--   -->
                        <div style="position: absolute; z-index: -1;">
                            <canvas id="genomicGridlines" height="{{200*shownTranscripts+34*hiddenTranscripts+150}}"
                                width="{{canvasSize}}">
                            </canvas>
                        </div>

                    </td>
                    <td width="30">

                    </td>
                    <td ng-show="viewMode=='all'|| viewMode=='protein'|| viewMode=='transcript' ||viewMode=='transcript_protein'"
                        class="resultTitle">
                        <span ng-show="viewMode=='all'||viewMode=='transcript_protein'">Transcript & Protein</span>
                        <span ng-show="viewMode=='transcript'">Transcript</span>
                        <span ng-show="viewMode=='protein'">Protein</span>
                        <div style="position: absolute; z-index: -1;">
                            <canvas id="proteinGridlines" height="{{200*shownTranscripts+34*hiddenTranscripts+150}}"
                                width="{{canvasSize}}">
                            </canvas>
                        </div>
                    </td>
                </tr>
                <tr>

                    <!--range-slider and scales-->
                    <td ng-show="viewMode=='all'|| viewMode=='genomic'">
                        <!-- scale view for transcripts -->
                        <span class="chromosomeLocation">{{::chromosomeLocation}}</span> <br>
                        <div style="width: {{canvasSize}}px;">
                            <input type="text" class="js-range-slider" id="genomic_range" value="" />
                        </div>
                        <canvas id="canvas-scale" height="130" width="{{canvasSize}}">
                        </canvas>

                    </td>
                    <td width="30">

                    </td>
                    <td ng-show="viewMode!='genomic'">
                        <br>
                        <!-- scale view for proteins -->
                        <div style="width: {{canvasSize-50}}px;">
                            <input type="text" class="js-range-slider" id="protein_range" value="" />
                        </div>
                        <canvas id="canvas-scale-protein" height="130" width="{{canvasSize}}">
                        </canvas>

                    </td>
                </tr>
                <tr id="fadeinDiv{{$index}}" ng-repeat="transcript in transcripts track by $index">
                    <td>
                        <!-- hide button -->
                        <button ng-click="hideTranscriptView($index)" class="btn blackButton" style="width: auto;"
                            ng-show="transcripts[$index].genomicView ||transcripts[$index].transcriptView||transcripts[$index].proteinView">
                            <span class="glyphicon glyphicon-eye-close"></span>
                        </button>

                        <!-- show button -->
                        <button ng-click="showTranscriptView($index)" class="btn blackButton" style="width: auto;"
                            ng-show="!(transcripts[$index].genomicView ||transcripts[$index].transcriptView||transcripts[$index].proteinView)">
                            <span class="glyphicon glyphicon-eye-open"></span>
                        </button>
                        <!-- genomic view -->
                        <a href="" ng-show="viewMode=='protein'"
                            ng-click="openWindow('protein',$index)">{{transcript.proteinId}}</a>
                        <a href=""
                            ng-show="viewMode=='genomic'||viewMode=='transcript'||viewMode=='all'||viewMode=='transcript_protein'"
                            ng-click="openWindow('transcript',$index)">{{transcript.name}}</a>
                        <br>
                        <canvas id="canvas-genomic{{$index}}" height="100" width="{{canvasSize}}"
                            ng-show="transcripts[$index].genomicView"></canvas>
                    </td>
                    <td width="30"
                        ng-show="viewMode=='all'&&(transcripts[$index].genomicView ||transcripts[$index].transcriptView||transcripts[$index].proteinView)">
                    </td>
                    <td
                        ng-show="viewMode!='genomic'&&(transcripts[$index].transcriptView||transcripts[$index].proteinView)">
                        <!-- transcript view -->
                        <a href=""
                            ng-show="transcripts[$index].transcriptView &&  viewMode!='transcript'&&  viewMode!='transcript_protein'"
                            ng-click="openWindow('transcript',$index)">{{transcript.name}}</a><br>
                        <canvas id="canvas-transcript{{$index}}" height="30" width="{{canvasSize}}"
                            ng-show="transcripts[$index].transcriptView"></canvas><br>
                        <!-- protein view -->
                        <a href=""
                            ng-show="transcripts[$index].proteinView && viewMode!='protein'&& viewMode!='transcript_protein'"
                            ng-click="openWindow('protein',$index)">{{transcript.protein_name}}</a><br>
                        <canvas id="canvas-protein{{$index}}" height="100" width="{{canvasSize}}"
                            ng-show="transcripts[$index].proteinView"></canvas>
                        <!-- extend protein view-->
                        <br>
                        <canvas id="canvas-protein-extend{{$index}}" height="100" width="{{canvasSize}}"
                            ng-show="transcripts[$index].proteinExtendView"></canvas>
                    </td>
                </tr>
            </table>

            <!-- exon positions for exons-->
            <div style="background-color: white;width: 100%;">
                <table class="exonColorTable">
                    <tr>
                        <th class="exonTableHeader">
                            color
                        </th>
                        <th class="exonTableHeader">
                            start coordinate
                        </th>
                        <th class="exonTableHeader">
                            end coordinate
                        </th>
                        <th class="exonTableHeader">
                            transcripts
                        </th>
                    </tr>
                    <tr class="exonTable" ng-repeat="exon in resultsCtrl.geneInfo.exonTable">
                        <td>
                            <div height="10" width="10" style="background-color:{{exon.color}}">&nbsp;&nbsp;&nbsp;</div>
                        </td>
                        <td>
                            {{numberToTextWithCommas(exon.startCoordinate)}}
                        </td>
                        <td>
                            {{numberToTextWithCommas(exon.endCoordinate)}}
                        </td>

                        <td style="text-align:left; width: 500px;">
                            {{exon.transcripts}}
                        </td>
                    </tr>
                </table>
            </div>
        </center>
    </div> <!-- this is for the search option-->
    <div ng-show="{{::noSearch}}" style="background-color: white;">
        <center>
            <h1>No Search has been found</h1>
        </center>
    </div>
    </div>
</body>

</html>